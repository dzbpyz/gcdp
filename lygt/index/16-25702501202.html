<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>质保书详情</title>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "PingFang SC", "Microsoft YaHei", sans-serif;
            background-color: #f0f2f5;
            color: #333;
            font-size: 16px; /* 基准字体大小 */
        }

        .container {
            max-width: 750px;
            margin: 0 auto;
            background-color: #ffffff;
        }

        .warranty-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #e8e8e8;
            cursor: pointer;
        }

        .warranty-info .id {
            font-weight: bold;
            font-size: 1.1em; /* 桌面端大小 */
            margin-bottom: 5px;
            color: #1f1f1f;
        }

        .warranty-info .date {
            font-size: 0.9em; /* 桌面端大小 */
            color: #595959;
        }

        .dropdown-arrow {
            --arrow-color: #8c8c8c;
            --arrow-rotation: 0deg;
            --arrow-font-size: 1.7em;
            --arrow-font-weight: normal;
            font-size: var(--arrow-font-size);
        }

        .arrow-char {
            display: inline-block;
            color: var(--arrow-color);
            transform: rotate(var(--arrow-rotation));
            font-weight: var(--arrow-font-weight);
            transition: transform 0.2s ease-in-out, color 0.2s ease-in-out, font-size 0.2s ease-in-out, font-weight 0.2s ease-in-out;
        }

        .warranty-item.active .dropdown-arrow {
             --arrow-color: #007bff;
             --arrow-rotation: 180deg;
             --arrow-font-size: 1.4em;
             --arrow-font-weight: bold;
        }

        .warranty-details {
            display: none;
            padding: 10px 15px 20px 15px; /* Default padding */
            border-bottom: 1px solid #e8e8e8;
            background-color: #fdfdfd;
            font-size: 0.9em;
        }

        .warranty-details.expanded {
            display: block;
        }

        /* CSS for the full-width image area */
        .full-width-image-area {
            padding: 5px 0; /* 5px padding top/bottom, 0 padding left/right. Adjust 5px as needed. */
        }

        .warranty-details > p {
            margin: 4px 0;
            line-height: 1.3;
            color: #333;
        }

        .section-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-top: 20px;
            margin-bottom: 24px;
            color: #1f1f1f;
        }
        .warranty-details > p + .section-title {
             margin-top: 15px;
        }
        .warranty-details > .section-title:first-child {
            margin-top: 0;
        }


        .title-divider {
            border: 0;
            height: 1px;
            background-color: #e0e0e0;
            margin-top: 0px;
            margin-bottom: 1px;
        }

        .details-list {
            margin-bottom: 15px;
        }

        .detail-entry {
            display: grid;
            /* 原来的: grid-template-columns: minmax(100px, 2fr) 1fr 1fr; */
            grid-template-columns: 3fr 2fr 2fr; /* 修改后 */
            gap: 8px;
            padding: 3px 0;
            align-items: center;
            line-height: 1.2;
        }

       .entry-value {
    text-align: left; /* “结果, %” 列左对齐 */
}
.entry-status {
    text-align: center; /* “判定” 列保持居中 (如果需要) */
}

        .detail-entry span {
            display: block;
        }

        .entry-label {
            text-align: left;
            word-break: break-word;
        }

     
        .detail-header .entry-label,
        .detail-header .entry-value,
        .detail-header .entry-status {
            font-weight: bold;
            color: #595959;
        }

        .certificate-image-container {
            padding: 10px 0; /* Original padding, will be overridden for full-width image */
        }

        /* Override .certificate-image-container padding when inside .full-width-image-area */
        .full-width-image-area .certificate-image-container {
            padding: 0;
        }

        .certificate-image-container img {
            display: block;
            width: 100%; /* Image takes full width of its container */
            height: auto;
            cursor: pointer; /* 让页面中的图片也有手型光标 */
        }

        .contact-section {
            padding: 20px 15px;
            background-color: #ffffff;
        }

        .contact-section .title {
            font-size: 1.0em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #1f1f1f;
        }

        .contact-section p {
            margin: 8px 0;
            line-height: 1.6;
            font-size: 0.95em;
            color: #333;
        }

        /* 灯箱样式 */
        .lightbox-overlay {
            position: fixed; /* 固定定位，覆盖整个屏幕 */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000; /* MODIFIED: 纯黑色背景 */
            z-index: 1000; /* 确保在最顶层 */
            display: flex; /* 使用 flex */
            align-items: center; /* 垂直居中 */
            justify-content: center; /* 默认水平居中，用于初次放大 */
            cursor: pointer; /* 提示用户背景可点击关闭 */
        }

        /* 当灯箱处于可滚动状态时的样式 */
        .lightbox-overlay.is-scrollable {
            overflow-x: auto; /* 允许水平滚动 */
            -webkit-overflow-scrolling: touch; /* iOS 惯性滚动 */
            justify-content: flex-start; /* 当可滚动时，让内容从左边开始 */
        }

        .lightbox-overlay img { /* MODIFIED: 第一次放大状态 */
            display: block;
            /* 目标：宽度为视口高度的100%，高度等比例 */
            width: 100vh; 
            height: auto;
            /* 约束：确保图片在视口内，并保留一些边距 */
            max-width: 95vw;  /* 例如：最大宽度为视口宽度的95% */
            max-height: 95vh; /* 例如：最大高度为视口高度的95% */
            
            margin: auto; /* 配合父级flex的center实现居中 */
            box-shadow: none; /* MODIFIED: 在纯黑背景下，原黑色阴影不可见，暂设为none */
            cursor: pointer; /* 图片也可点击 */
            transition: width 0.3s ease-in-out, height 0.3s ease-in-out, max-width 0.3s ease-in-out, max-height 0.3s ease-in-out;
            object-fit: contain; /* 确保图片完整显示并保持比例 */
            flex-shrink: 0; /* 防止图片在flex容器中被不期望地缩小 */
        }

        .lightbox-overlay img.lightbox-image-zoomed { /* 双击后再次放大状态 */
            height: 100vh;       /* 图片高度设置为视口高度的100% */
            width: auto;         /* 宽度将根据新的高度等比例缩放 */
            max-width: none;     /* 允许图片宽度根据其100vh的高度自由缩放，即使超出视口宽度 */
            box-shadow: none;    /* MODIFIED: 再次放大时可移除阴影，与首次放大保持一致 */
            flex-shrink: 0;      /* 确保图片不会因为父flex容器的约束而缩小 */
            margin: 0;           /* 当可滚动且父级是flex-start时，移除auto margin确保从左边开始 */
        }

        /* --- 媒体查询：针对手机屏幕 --- */
        @media (max-width: 767px) { /* 当屏幕宽度 <= 767px 时应用以下样式 */
            .warranty-info .id {
                font-size: 0.9em; /* 调整为约 16px (相对于body的16px) */
            }

            .warranty-info .date {
                font-size: 0.85em; /* 调整为约 13.6px (相对于body的16px) */
            }
			 /* --- 新增：修改联系方式区域在手机端的字体大小 --- */
            .contact-section .title {
                font-size: 1.0em; /* 示例：手机端“联系方式”标题字体大小，可调整 */
                                  /* 例如，原为1.2em，手机上改为1.0em或1.1em */
            }

            .contact-section p {
                font-size: 0.88em; /* 示例：手机端电话号码等段落字体大小，可调整 */
                                   /* 例如，原为0.95em，手机上改为0.85em或0.9em */
            }
            /* --- 新增结束 --- */
        }
        /* --- 媒体查询结束 --- */

    </style>
</head>
<body>

    <div class="container">
             <!-- 质保书条目 1 (数据源模板) -->
        <div class="warranty-item active" data-source-item-template>
            <div class="warranty-info">
                <div class="id" data-source-field="idText">质保书号:M02505080033</div>
                <div class="date" data-source-field="dateText">签发日期: 2025-05-08</div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details expanded" data-source-details-template>
            <p data-source-p="manufacturer">生产厂家: 凌源钢铁股份有限公司</p>
            <p data-source-p="productName">产品名称: 热轧带肋钢筋 (直条)</p>
            <!-- ... 更多 <p> 和 details-list 内容保持不变 ... -->
          <p data-source-p="productionDate">生产日期: 2025-05-08</p>
            <p data-source-p="furnaceNo">炉号: 25702501202</p>
            <p data-source-p="steelGrade">钢种: 热轧带肋钢筋 (直条)</p>
            <p data-source-p="specification">规格: Φ16</p>
            <p data-source-p="weight">重量: 2.84400t</p>
            <p data-source-p="bundleNo">捆号 (卷号):B2254529801900</p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-source-component="C">
                    <span class="entry-label">C (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-source-value>24</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-component="Si">
                    <span class="entry-label">Si (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-source-value>25</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-component="Mn">
                    <span class="entry-label">Mn (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-source-value>139</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-component="P">
                    <span class="entry-label">P (10 <sup>-3</sup>)</span>
                    <span class="entry-value" data-source-value>29</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-component="S">
                    <span class="entry-label">S (10 <sup>-3</sup>)</span>
                    <span class="entry-value" data-source-value>26</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-component="Ceq">
                    <span class="entry-label">Ceq (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-source-value>49</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
            </div>

            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-source-property="actualThickness">
                    <span class="entry-label">材料实际厚度</span>
                    <span class="entry-value" data-source-value>22</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-source-value>14</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="yieldStrength">
                    <span class="entry-label">屈服强度</span>
                    <span class="entry-value" data-source-value>445.0</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="tensileStrength">
                    <span class="entry-label">抗拉强度</span>
                    <span class="entry-value" data-source-value>630.0</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="yieldRatio">
                    <span class="entry-label">屈强比</span>
                    <span class="entry-value" data-source-value>-1.000</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-source-value>90</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-source-value>4d</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-source-value>纵向</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
            </div>
        </div>

        <!-- 质保书条目 2 -->
        <div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
       <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weight"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNo"></span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>

            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>


        <!-- 质保书条目 3 -->
        <div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weight"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNo"></span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>

            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldStrength">
                    <span class="entry-label">屈服强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileStrength">
                    <span class="entry-label">抗拉强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldRatio">
                    <span class="entry-label">屈强比</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

		<!-- 质保书条目 4 -->
        <div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weight"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNo"></span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>

            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>
		<!-- 质保书条目 5 -->
        <div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>

                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weight"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNo"></span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>

            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

		<!-- 质保书条目 6 -->
		<div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details data-item-index="6"> <!-- 特殊标记条目6 -->
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weight"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNo"></span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-component="C">
                    <span class="entry-label">C (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-component="Si">
                    <span class="entry-label">Si (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-component="Mn">
                    <span class="entry-label">Mn (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-component="P">
                    <span class="entry-label">P (10 <sup>-3</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-component="S">
                    <span class="entry-label">S (10 <sup>-3</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-component="Ceq">
                    <span class="entry-label">Ceq (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>

            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="actualThickness">
                    <span class="entry-label">材料实际厚度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldStrength">
                    <span class="entry-label">屈服强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileStrength">
                    <span class="entry-label">抗拉强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldRatio">
                    <span class="entry-label">屈强比</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>

                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

		<!-- 质保书条目 7 -->
		<div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weight"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNo"></span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldStrength">
                    <span class="entry-label">屈服强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileStrength">
                    <span class="entry-label">抗拉强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldRatio">
                    <span class="entry-label">屈强比</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

		<!-- 质保书条目 8 -->
		<div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weight"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNo"></span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>
		<!-- 质保书条目 9 -->
		<div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weight"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNo"></span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>
		<!-- 质保书条目 10 -->
		<div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weight"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNo"></span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

        <!-- 证书图片直接显示 -->
        <div class="warranty-details expanded full-width-image-area">
            <div class="certificate-image-container">
                 <img src="../pdf/材质单示例.png" alt="产品质量证明书"> <!-- 默认图片 -->
            </div>
        </div>


        <!-- 联系方式区域 (独立于可折叠条目) - 保持原样 -->
        <div class="contact-section">
            <div class="title">联系方式</div>
            <p class="phone-line">销售电话: 建材0421-6838215、特钢0421-6838924、</p>
            <p class="phone-line">宽带0421-6838211</p>
            <p>服务热线: 400-0421-555</p>
        </div>

    </div> <!-- 这是 .container 的结束标签 -->

    <!-- 灯箱的 HTML 结构 (已移除关闭按钮) -->
    <div id="imageLightbox" class="lightbox-overlay" style="display: none;">
        <img id="lightboxImage" src="" alt="证书放大图">
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
                                 // --- START: Dynamically set certificate image based on URL parameter ---
            const certificateImageElement = document.querySelector('.full-width-image-area .certificate-image-container img');
            const defaultImageSrc = certificateImageElement ? certificateImageElement.src : '../pdf/001.png'; // 保存原始默认图片
            const defaultImageAlt = certificateImageElement ? certificateImageElement.alt : '产品质量证明书';

            if (certificateImageElement) {
                try {
                    const urlParams = new URLSearchParams(window.location.search);
                    const pdfParamValue = urlParams.get('pdf');

                    if (pdfParamValue) {
                        // 1. 优先处理用户明确指定了后缀的情况 (e.g., myimage.jpg, another.png)
                        //    我们通过检查原始参数值中是否包含点号，并且这个点号不是唯一的字符
                        if (pdfParamValue.includes('.') && pdfParamValue.lastIndexOf('.') < pdfParamValue.length - 1) {
                            let explicitFileName = pdfParamValue.replace(/[^\w\-\.]/g, ''); // 允许字母数字、连字符、下划线、点
                            if (explicitFileName) {
                                certificateImageElement.src = `../pdf/${explicitFileName}`;
                                const baseName = explicitFileName.substring(0, explicitFileName.lastIndexOf('.'));
                                certificateImageElement.alt = `产品质量证明书 ${baseName}`;
                                // 为明确指定的文件设置一个错误处理器
                                certificateImageElement.onerror = function() {
                                    console.error(`Error loading explicitly specified image: ../pdf/${explicitFileName}. Reverting to default.`);
                                    certificateImageElement.src = defaultImageSrc; // 明确指定的文件加载失败，恢复默认
                                    certificateImageElement.alt = defaultImageAlt;
                                    certificateImageElement.onerror = null; // 清除错误处理器，避免循环
                                };
                                certificateImageElement.onload = function() {
                                    certificateImageElement.onerror = null; // 加载成功，清除错误处理器
                                };
                            } else {
                                console.warn('Invalid "pdf" parameter (with extension) after sanitization:', pdfParamValue);
                                // 无效参数，使用默认图片 (src 和 alt 已是默认)
                            }
                        } else {
                            // 2. 处理用户只提供了文件名，没有后缀的情况 (e.g., myimage)
                            let baseFileName = pdfParamValue.replace(/[^\w\-]/g, ''); // 只允许字母数字、连字符、下划线
                            if (baseFileName) {
                                const extensionsToTry = ['png', 'jpg', 'jpeg', 'gif', 'webp']; // 您可以按需调整尝试的后缀顺序和类型
                                let foundImage = false;

                                function tryLoadNextExtension(index) {
                                    if (index >= extensionsToTry.length) {
                                        // 所有尝试都失败了
                                        console.warn(`Image not found for base name "${baseFileName}" with any attempted extension. Reverting to default.`);
                                        certificateImageElement.src = defaultImageSrc; // 所有尝试失败，恢复默认
                                        certificateImageElement.alt = defaultImageAlt;
                                        certificateImageElement.onerror = null;
                                        return;
                                    }

                                    const currentExtension = extensionsToTry[index];
                                    const potentialSrc = `../pdf/${baseFileName}.${currentExtension}`;
                                    certificateImageElement.src = potentialSrc;

                                    certificateImageElement.onload = function() {
                                        console.log(`Successfully loaded: ${potentialSrc}`);
                                        certificateImageElement.alt = `产品质量证明书 ${baseFileName}`;
                                        foundImage = true;
                                        certificateImageElement.onerror = null; // 清除错误处理器
                                        certificateImageElement.onload = null;  // 清除成功处理器
                                    };

                                    certificateImageElement.onerror = function() {
                                        console.log(`Failed to load: ${potentialSrc}. Trying next extension...`);
                                        tryLoadNextExtension(index + 1); // 尝试下一个后缀
                                    };
                                }
                                tryLoadNextExtension(0); // 从第一个后缀开始尝试
                            } else {
                                console.warn('Invalid "pdf" parameter (no extension) after sanitization:', pdfParamValue);
                                // 无效参数，使用默认图片 (src 和 alt 已是默认)
                            }
                        }
                    }
                    // 如果没有 pdfParamValue, 则图片元素将使用其在HTML中定义的默认src和alt
                } catch (e) {
                    console.error("Error processing URL parameters for PDF image:", e);
                    if (certificateImageElement) {
                        certificateImageElement.src = defaultImageSrc; // 发生其他错误，恢复默认
                        certificateImageElement.alt = defaultImageAlt;
                    }
                }
            } else {
                console.error('Certificate image element not found for dynamic update.');
            }
            // --- END: Dynamically set certificate image ---


            // --- 数据填充逻辑 (保持不变) ---
            const sourceItemTemplate = document.querySelector('[data-source-item-template]');
            const sourceDetailsTemplate = document.querySelector('[data-source-details-template]');

            if (!sourceItemTemplate || !sourceDetailsTemplate) {
                console.error('Source template elements not found!');
                return;
            }

            const sourceData = {
                idText: sourceItemTemplate.querySelector('[data-source-field="idText"]')?.textContent || '',
                dateText: sourceItemTemplate.querySelector('[data-source-field="dateText"]')?.textContent || '',
                pValues: {},
                components: {},
                properties: {}
            };

            sourceDetailsTemplate.querySelectorAll('[data-source-p]').forEach(pElement => {
                const key = pElement.dataset.sourceP;
                const textContent = pElement.textContent || '';
                const value = textContent.substring(textContent.indexOf(':') + 1).trim();
                if (key) sourceData.pValues[key] = value;
            });

            sourceDetailsTemplate.querySelectorAll('[data-source-component]').forEach(compElement => {
                const key = compElement.dataset.sourceComponent;
                const valueElement = compElement.querySelector('[data-source-value]');
                const statusElement = compElement.querySelector('[data-source-status]');
                if (key && valueElement && statusElement) {
                    sourceData.components[key] = {
                        value: valueElement.textContent || '',
                        status: statusElement.textContent || ''
                    };
                }
            });

            const propertiesToCopyFromSource = [
                'actualThickness', 'gaugeCode', 'yieldStrength', 'tensileStrength',
                'yieldRatio', 'bendingAngle', 'bendingDiameter', 'tensileDirection'
            ];
            propertiesToCopyFromSource.forEach(propKey => {
                 const propElement = sourceDetailsTemplate.querySelector(`[data-source-property="${propKey}"]`);
                 const valueElement = propElement?.querySelector('[data-source-value]');
                 const statusElement = propElement?.querySelector('[data-source-status]');
                 if (propElement && valueElement && statusElement){
                    sourceData.properties[propKey] = {
                        value: valueElement.textContent || '',
                        status: statusElement.textContent || ''
                    };
                 }
            });

            const targetItems = document.querySelectorAll('[data-target-item]');
            targetItems.forEach(targetItem => {
                const targetDetails = targetItem.nextElementSibling;
                if (!targetDetails || !targetDetails.hasAttribute('data-target-details')) return;

                const targetIdField = targetItem.querySelector('[data-target-field="idText"]');
                if (targetIdField) targetIdField.textContent = sourceData.idText;
                const targetDateField = targetItem.querySelector('[data-target-field="dateText"]');
                if (targetDateField) targetDateField.textContent = sourceData.dateText;

                for (const key in sourceData.pValues) {
                    const targetPValueSpan = targetDetails.querySelector(`[data-target-value-for-p="${key}"]`);
                    if (targetPValueSpan) targetPValueSpan.textContent = sourceData.pValues[key];
                }

                for (const key in sourceData.properties) {
                     const targetPropEntry = targetDetails.querySelector(`[data-target-property="${key}"]`);
                     if (targetPropEntry) {
                         const targetValueSpan = targetPropEntry.querySelector('[data-target-value]');
                         const targetStatusSpan = targetPropEntry.querySelector('[data-target-status]');
                         if (targetValueSpan && sourceData.properties[key]?.value !== undefined) targetValueSpan.textContent = sourceData.properties[key].value;
                         if (targetStatusSpan && sourceData.properties[key]?.status !== undefined) targetStatusSpan.textContent = sourceData.properties[key].status;
                     }
                }

                if (targetDetails.dataset.itemIndex === '6') {
                    for (const key in sourceData.components) {
                        const targetCompEntry = targetDetails.querySelector(`[data-target-component="${key}"]`);
                        if (targetCompEntry) {
                            const targetValueSpan = targetCompEntry.querySelector('[data-target-value]');
                            const targetStatusSpan = targetCompEntry.querySelector('[data-target-status]');
                            if (targetValueSpan && sourceData.components[key]?.value !== undefined) targetValueSpan.textContent = sourceData.components[key].value;
                            if (targetStatusSpan && sourceData.components[key]?.status !== undefined) targetStatusSpan.textContent = sourceData.components[key].status;
                        }
                    }
                }
            });

            // --- 折叠/展开逻辑 (保持不变) ---
            const warrantyItems = document.querySelectorAll('.warranty-item'); 
            warrantyItems.forEach(item => {
                item.addEventListener('click', function() {
                    const currentDetails = this.nextElementSibling;
                    const isActive = this.classList.contains('active');
                    document.querySelectorAll('.warranty-item').forEach(otherItem => {
                        if (otherItem !== this) {
                            otherItem.classList.remove('active');
                            const otherDetails = otherItem.nextElementSibling;
                            if (otherDetails && otherDetails.classList.contains('warranty-details') && !otherDetails.classList.contains('full-width-image-area')) { 
                                otherDetails.classList.remove('expanded');
                            }
                        }
                    });
                    if (currentDetails && currentDetails.classList.contains('warranty-details') && !currentDetails.classList.contains('full-width-image-area')) {
                        if (isActive) {
                            this.classList.remove('active');
                            currentDetails.classList.remove('expanded');
                        } else {
                            this.classList.add('active');
                            currentDetails.classList.add('expanded');
                        }
                    }
                });
            });

            // --- 灯箱逻辑 (支持单击/双击切换缩放和关闭，二次放大可滑动) ---
            // Note: originalCertificateImage now refers to certificateImageElement defined above
            const originalCertificateImage = certificateImageElement; // Use the potentially updated image
            const lightbox = document.getElementById('imageLightbox'); // The .lightbox-overlay element
            const lightboxImg = document.getElementById('lightboxImage');

            let lightboxZoomState = 0; // 0: hidden, 1: normal zoom, 2: extra zoom
            let clickTimer = null;

            if (originalCertificateImage && lightbox && lightboxImg) {
                originalCertificateImage.addEventListener('click', function() {
                    openLightbox(this.src); // 'this.src' will have the dynamically set path
                });

                function openLightbox(src) {
                    lightboxImg.src = src;
                    lightboxZoomState = 1; 
                    lightboxImg.classList.remove('lightbox-image-zoomed');
                    lightbox.classList.remove('is-scrollable'); // Ensure not scrollable on open
                    lightbox.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                }

                function closeLightbox() {
                    lightbox.style.display = 'none';
                    lightboxImg.src = '';
                    lightboxZoomState = 0; 
                    document.body.style.overflow = 'auto';
                    lightboxImg.classList.remove('lightbox-image-zoomed');
                    lightbox.classList.remove('is-scrollable'); // Ensure not scrollable on close
                }

                lightbox.addEventListener('click', function(event) {
                    if (event.target === lightbox) { 
                        closeLightbox();
                    }
                });

                lightboxImg.addEventListener('click', function(event) {
                    event.stopPropagation(); 

                    if (clickTimer) { 
                        clearTimeout(clickTimer);
                        clickTimer = null;
                        handleDoubleClick();
                    } else { 
                        clickTimer = setTimeout(() => {
                            clickTimer = null;
                            handleSingleClick();
                        }, 250); 
                    }
                });
                
                function handleSingleClick() {
                    closeLightbox();
                }

                function handleDoubleClick() {
                    if (lightboxZoomState === 1) { 
                        lightboxImg.classList.add('lightbox-image-zoomed');
                        lightbox.classList.add('is-scrollable'); // Enable scrolling for zoomed state
                        lightboxZoomState = 2;
                    } else if (lightboxZoomState === 2) { 
                        lightboxImg.classList.remove('lightbox-image-zoomed');
                        lightbox.classList.remove('is-scrollable'); // Disable scrolling
                        lightboxZoomState = 1;
                    }
                }

                document.addEventListener('keydown', function(event) {
                    if (event.key === 'Escape' && lightboxZoomState !== 0) {
                        closeLightbox();
                    }
                });

            } else {
                if (!originalCertificateImage) console.error('Original certificate image (for lightbox) not found! Check selector or if it was dynamically removed.');
                if (!lightbox) console.error('Lightbox overlay element not found!');
                if (!lightboxImg) console.error('Lightbox image element not found!');
            }
        });
    </script>


</body>
</html>