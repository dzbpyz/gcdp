<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>质保书详情</title>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "PingFang SC", "Microsoft YaHei", sans-serif;
            background-color: #f0f2f5;
            color: #333;
            font-size: 16px; /* 基准字体大小 */
        }

        .container {
            max-width: 750px;
            margin: 0 auto;
            background-color: #ffffff;
        }

        .warranty-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #e8e8e8;
            cursor: pointer;
        }

        .warranty-info .id {
            font-weight: bold;
            font-size: 1.1em; /* 桌面端大小 */
            margin-bottom: 5px;
            color: #1f1f1f;
        }

        .warranty-info .date {
            font-size: 0.9em; /* 桌面端大小 */
            color: #595959;
        }

        .dropdown-arrow {
            --arrow-color: #8c8c8c;
            --arrow-rotation: 0deg;
            --arrow-font-size: 1.7em;
            --arrow-font-weight: normal;
            font-size: var(--arrow-font-size);
        }

        .arrow-char {
            display: inline-block;
            color: var(--arrow-color);
            transform: rotate(var(--arrow-rotation));
            font-weight: var(--arrow-font-weight);
            transition: transform 0.2s ease-in-out, color 0.2s ease-in-out, font-size 0.2s ease-in-out, font-weight 0.2s ease-in-out;
        }

        .warranty-item.active .dropdown-arrow {
             --arrow-color: #007bff;
             --arrow-rotation: 180deg;
             --arrow-font-size: 1.4em;
             --arrow-font-weight: bold;
        }

        .warranty-details {
            display: none;
            padding: 10px 15px 20px 15px; /* Default padding */
            border-bottom: 1px solid #e8e8e8;
            background-color: #fdfdfd;
            font-size: 0.9em;
        }

        .warranty-details.expanded {
            display: block;
        }

        /* CSS for the full-width image area */
        .full-width-image-area {
            padding: 5px 0; /* 5px padding top/bottom, 0 padding left/right. Adjust 5px as needed. */
        }

        .warranty-details > p {
            margin: 4px 0;
            line-height: 1.3;
            color: #333;
        }

        .section-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-top: 20px;
            margin-bottom: 24px;
            color: #1f1f1f;
        }
        .warranty-details > p + .section-title {
             margin-top: 15px;
        }
        .warranty-details > .section-title:first-child {
            margin-top: 0;
        }


        .title-divider {
            border: 0;
            height: 1px;
            background-color: #e0e0e0;
            margin-top: 0px;
            margin-bottom: 1px;
        }

        .details-list {
            margin-bottom: 15px;
        }

        .detail-entry {
            display: grid;
            grid-template-columns: 3fr 2fr 2fr;
            gap: 8px;
            padding: 3px 0;
            align-items: center;
            line-height: 1.2;
        }

       .entry-value {
            text-align: left;
        }
        .entry-status {
            text-align: center;
        }

        .detail-entry span {
            display: block;
        }

        .entry-label {
            text-align: left;
            word-break: break-word;
        }

     
        .detail-header .entry-label,
        .detail-header .entry-value,
        .detail-header .entry-status {
            font-weight: bold;
            color: #595959;
        }

        .certificate-image-container {
            padding: 10px 0;
        }

        .full-width-image-area .certificate-image-container {
            padding: 0;
        }

        .certificate-image-container img {
            display: block;
            width: 100%;
            height: auto;
            cursor: pointer;
        }

        .contact-section {
            padding: 20px 15px;
            background-color: #ffffff;
        }

        .contact-section .title {
            font-size: 1.0em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #1f1f1f;
        }

        .contact-section p {
            margin: 8px 0;
            line-height: 1.6;
            font-size: 0.95em;
            color: #333;
        }

        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .lightbox-overlay.is-scrollable {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            justify-content: flex-start;
        }

        .lightbox-overlay img {
            display: block;
            width: 100vh; 
            height: auto;
            max-width: 95vw;
            max-height: 95vh;
            margin: auto;
            box-shadow: none;
            cursor: pointer;
            transition: width 0.3s ease-in-out, height 0.3s ease-in-out, max-width 0.3s ease-in-out, max-height 0.3s ease-in-out;
            object-fit: contain;
            flex-shrink: 0;
        }

        .lightbox-overlay img.lightbox-image-zoomed {
            height: 100vh;
            width: auto;
            max-width: none;
            box-shadow: none;
            flex-shrink: 0;
            margin: 0;
        }

        @media (max-width: 767px) {
            .warranty-info .id {
                font-size: 0.9em;
            }
            .warranty-info .date {
                font-size: 0.85em;
            }
            .contact-section .title {
                font-size: 1.0em;
            }
            .contact-section p {
                font-size: 0.88em;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- 质保书条目 1 (数据源模板) -->
        <div class="warranty-item active" data-source-item-template>
            <div class="warranty-info">
                <div class="id" data-source-field="idText">质保书号:M02506250105</div>
                <div class="date" data-source-field="dateText">签发日期: 2025-06-25</div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details expanded" data-source-details-template>
            <p data-source-p="manufacturer">生产厂家: 凌源钢铁股份有限公司</p>
            <p data-source-p="productName">产品名称: 热轧光圆钢筋 (盘圆)</p>
            <p data-source-p="productionDate">生产日期: 2025-05-08</p>
            <p data-source-p="furnaceNo">炉号: 25702501202</p>
            <p data-source-p="steelGrade">钢种:  热轧光圆钢筋 (盘圆)</p>
            <p data-source-p="specification">规格: Φ8</p>
            <!-- 修改点1: 重量字段结构调整 -->
            <p data-source-p="weight">重量: <span data-source-value-part="weightValue">2844</span><span data-source-value-part="weightUnit">kg</span></p>
            <!-- 修改点2: 捆号字段结构调整 -->
            <p data-source-p="bundleNo">捆号 (卷号): <span data-source-value-part="bundleNoValue">B2254529802011</span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-source-component="C">
                    <span class="entry-label">C (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-source-value>24</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-component="Si">
                    <span class="entry-label">Si (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-source-value>25</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-component="Mn">
                    <span class="entry-label">Mn (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-source-value>139</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-component="P">
                    <span class="entry-label">P (10 <sup>-3</sup>)</span>
                    <span class="entry-value" data-source-value>29</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-component="S">
                    <span class="entry-label">S (10 <sup>-3</sup>)</span>
                    <span class="entry-value" data-source-value>26</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-component="Ceq">
                    <span class="entry-label">Ceq (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-source-value>49</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
            </div>

            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-source-property="actualThickness">
                    <span class="entry-label">材料实际厚度</span>
                    <span class="entry-value" data-source-value>22</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-source-value>14</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="yieldStrength">
                    <span class="entry-label">屈服强度</span>
                    <span class="entry-value" data-source-value>445.0</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="tensileStrength">
                    <span class="entry-label">抗拉强度</span>
                    <span class="entry-value" data-source-value>630.0</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="yieldRatio">
                    <span class="entry-label">屈强比</span>
                    <span class="entry-value" data-source-value>-1.000</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-source-value>90</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-source-value>4d</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
                <div class="detail-entry" data-source-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-source-value>纵向</span>
                    <span class="entry-status" data-source-status>合格</span>
                </div>
            </div>
        </div>

        <!-- 质保书条目 2 -->
        <div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
       <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <!-- 目标条目中的重量 -->
            <p>重量: <span data-target-value-for-p="weightValue"></span><span data-target-value-for-p="weightUnit"></span></p>
            <!-- 目标条目中的捆号 -->
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNoValue"></span></p>

            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>

            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

        <!-- 质保书条目 3 (后续条目也需要同样修改重量和捆号的HTML结构) -->
        <div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weightValue"></span><span data-target-value-for-p="weightUnit"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNoValue"></span></p>
            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldStrength">
                    <span class="entry-label">屈服强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileStrength">
                    <span class="entry-label">抗拉强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldRatio">
                    <span class="entry-label">屈强比</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

		<!-- 质保书条目 4 -->
        <div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weightValue"></span><span data-target-value-for-p="weightUnit"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNoValue"></span></p>
            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>
		<!-- 质保书条目 5 -->
        <div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weightValue"></span><span data-target-value-for-p="weightUnit"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNoValue"></span></p>
            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

		<!-- 质保书条目 6 -->
		<div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details data-item-index="6">
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weightValue"></span><span data-target-value-for-p="weightUnit"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNoValue"></span></p>
            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-component="C">
                    <span class="entry-label">C (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-component="Si">
                    <span class="entry-label">Si (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-component="Mn">
                    <span class="entry-label">Mn (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-component="P">
                    <span class="entry-label">P (10 <sup>-3</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-component="S">
                    <span class="entry-label">S (10 <sup>-3</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-component="Ceq">
                    <span class="entry-label">Ceq (10 <sup>-2</sup>)</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="actualThickness">
                    <span class="entry-label">材料实际厚度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldStrength">
                    <span class="entry-label">屈服强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileStrength">
                    <span class="entry-label">抗拉强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldRatio">
                    <span class="entry-label">屈强比</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

		<!-- 质保书条目 7 -->
		<div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weightValue"></span><span data-target-value-for-p="weightUnit"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNoValue"></span></p>
            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldStrength">
                    <span class="entry-label">屈服强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileStrength">
                    <span class="entry-label">抗拉强度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="yieldRatio">
                    <span class="entry-label">屈强比</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

		<!-- 质保书条目 8 -->
		<div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weightValue"></span><span data-target-value-for-p="weightUnit"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNoValue"></span></p>
            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>
		<!-- 质保书条目 9 -->
		<div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weightValue"></span><span data-target-value-for-p="weightUnit"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNoValue"></span></p>
            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>
		<!-- 质保书条目 10 -->
		<div class="warranty-item" data-target-item>
            <div class="warranty-info">
                <div class="id" data-target-field="idText"></div>
                <div class="date" data-target-field="dateText"></div>
            </div>
            <div class="dropdown-arrow">
                <span class="arrow-char">∨</span>
            </div>
        </div>
        <div class="warranty-details" data-target-details>
            <p>生产厂家: <span data-target-value-for-p="manufacturer"></span></p>
            <p>产品名称: <span data-target-value-for-p="productName"></span></p>
            <p>生产日期: <span data-target-value-for-p="productionDate"></span></p>
            <p>炉号: <span data-target-value-for-p="furnaceNo"></span></p>
            <p>钢种: <span data-target-value-for-p="steelGrade"></span></p>
            <p>规格: <span data-target-value-for-p="specification"></span></p>
            <p>重量: <span data-target-value-for-p="weightValue"></span><span data-target-value-for-p="weightUnit"></span></p>
            <p>捆号 (卷号): <span data-target-value-for-p="bundleNoValue"></span></p>
            <div class="section-title">成分信息</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">成分</span>
                    <span class="entry-value">结果, %</span>
                    <span class="entry-status">判定</span>
                </div>
            </div>
            <div class="section-title">物理特性</div>
            <hr class="title-divider">
            <div class="details-list">
                <div class="detail-entry detail-header">
                    <span class="entry-label">项目</span>
                    <span class="entry-value">结果</span>
                    <span class="entry-status">判定</span>
                </div>
                <div class="detail-entry" data-target-property="gaugeCode">
                    <span class="entry-label">标距代码</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingAngle">
                    <span class="entry-label">弯曲角度</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="bendingDiameter">
                    <span class="entry-label">弯曲直径</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
                <div class="detail-entry" data-target-property="tensileDirection">
                    <span class="entry-label">拉伸试验方向</span>
                    <span class="entry-value" data-target-value></span>
                    <span class="entry-status" data-target-status></span>
                </div>
            </div>
        </div>

        <!-- 证书图片直接显示 -->
        <div class="warranty-details expanded full-width-image-area">
            <div class="certificate-image-container">
                 <img src="../pdf/材质单示例.png" alt="产品质量证明书">
            </div>
        </div>

        <!-- 联系方式区域 -->
        <div class="contact-section">
            <div class="title">联系方式</div>
            <p class="phone-line">销售电话: 建材0421-6838215、特钢0421-6838924、</p>
            <p class="phone-line">宽带0421-6838211</p>
            <p>服务热线: 400-0421-555</p>
        </div>

    </div>

    <!-- 灯箱 -->
    <div id="imageLightbox" class="lightbox-overlay" style="display: none;">
        <img id="lightboxImage" src="" alt="证书放大图">
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- 修改点3: 获取URL参数 zl (重量) 和 kh (捆号) ---
            const urlParams = new URLSearchParams(window.location.search);
            const pdfParamValue = urlParams.get('pdf');
            const zlParamValue = urlParams.get('zl'); // 获取重量参数
            const khParamValue = urlParams.get('kh'); // 获取捆号参数

            // --- 动态设置证书图片 (逻辑保持，但确保其在数据处理之前) ---
            const certificateImageElement = document.querySelector('.full-width-image-area .certificate-image-container img');
            const defaultImageSrc = certificateImageElement ? certificateImageElement.src : '../pdf/001.png'; 
            const defaultImageAlt = certificateImageElement ? certificateImageElement.alt : '产品质量证明书';

            if (certificateImageElement) {
                try {
                    if (pdfParamValue) {
                        if (pdfParamValue.includes('.') && pdfParamValue.lastIndexOf('.') < pdfParamValue.length - 1) {
                            let explicitFileName = pdfParamValue.replace(/[^\w\-\.]/g, ''); 
                            if (explicitFileName) {
                                certificateImageElement.src = `../pdf/${explicitFileName}`;
                                const baseName = explicitFileName.substring(0, explicitFileName.lastIndexOf('.'));
                                certificateImageElement.alt = `产品质量证明书 ${baseName}`;
                                certificateImageElement.onerror = function() {
                                    console.error(`Error loading explicitly specified image: ../pdf/${explicitFileName}. Reverting to default.`);
                                    certificateImageElement.src = defaultImageSrc; 
                                    certificateImageElement.alt = defaultImageAlt;
                                    certificateImageElement.onerror = null; 
                                };
                                certificateImageElement.onload = function() {
                                    certificateImageElement.onerror = null; 
                                };
                            } else {
                                console.warn('Invalid "pdf" parameter (with extension) after sanitization:', pdfParamValue);
                            }
                        } else {
                            let baseFileName = pdfParamValue.replace(/[^\w\-]/g, ''); 
                            if (baseFileName) {
                                const extensionsToTry = ['png', 'jpg', 'jpeg', 'gif', 'webp']; 
                                let foundImage = false;
                                function tryLoadNextExtension(index) {
                                    if (index >= extensionsToTry.length) {
                                        console.warn(`Image not found for base name "${baseFileName}" with any attempted extension. Reverting to default.`);
                                        certificateImageElement.src = defaultImageSrc; 
                                        certificateImageElement.alt = defaultImageAlt;
                                        certificateImageElement.onerror = null;
                                        return;
                                    }
                                    const currentExtension = extensionsToTry[index];
                                    const potentialSrc = `../pdf/${baseFileName}.${currentExtension}`;
                                    certificateImageElement.src = potentialSrc;
                                    certificateImageElement.onload = function() {
                                        console.log(`Successfully loaded: ${potentialSrc}`);
                                        certificateImageElement.alt = `产品质量证明书 ${baseFileName}`;
                                        foundImage = true;
                                        certificateImageElement.onerror = null; 
                                        certificateImageElement.onload = null;  
                                    };
                                    certificateImageElement.onerror = function() {
                                        console.log(`Failed to load: ${potentialSrc}. Trying next extension...`);
                                        tryLoadNextExtension(index + 1); 
                                    };
                                }
                                tryLoadNextExtension(0); 
                            } else {
                                console.warn('Invalid "pdf" parameter (no extension) after sanitization:', pdfParamValue);
                            }
                        }
                    }
                } catch (e) {
                    console.error("Error processing URL parameters for PDF image:", e);
                    if (certificateImageElement) {
                        certificateImageElement.src = defaultImageSrc; 
                        certificateImageElement.alt = defaultImageAlt;
                    }
                }
            } else {
                console.error('Certificate image element not found for dynamic update.');
            }

            // --- 数据提取与填充逻辑 ---
            const sourceItemTemplate = document.querySelector('[data-source-item-template]');
            const sourceDetailsTemplate = document.querySelector('[data-source-details-template]');

            if (!sourceItemTemplate || !sourceDetailsTemplate) {
                console.error('数据源模板元素未找到!');
                return;
            }

            const sourceData = {
                idText: sourceItemTemplate.querySelector('[data-source-field="idText"]')?.textContent || '',
                dateText: sourceItemTemplate.querySelector('[data-source-field="dateText"]')?.textContent || '',
                pValues: {}, // 用于存储所有 <p> 标签对应的值
                components: {},
                properties: {}
            };

            // 提取源模板中 <p> 标签的数据
            sourceDetailsTemplate.querySelectorAll('[data-source-p]').forEach(pElement => {
                const pKey = pElement.dataset.sourceP;
                if (pKey === 'weight') { // 特殊处理重量
                    const valueSpan = pElement.querySelector('[data-source-value-part="weightValue"]');
                    const unitSpan = pElement.querySelector('[data-source-value-part="weightUnit"]');
                    if (valueSpan) sourceData.pValues.weightValue = valueSpan.textContent.trim();
                    if (unitSpan) sourceData.pValues.weightUnit = unitSpan.textContent.trim();
                } else if (pKey === 'bundleNo') { // 特殊处理捆号
                    const valueSpan = pElement.querySelector('[data-source-value-part="bundleNoValue"]');
                    if (valueSpan) sourceData.pValues.bundleNoValue = valueSpan.textContent.trim();
                } else { // 其他普通 <p> 标签
                    const textContent = pElement.textContent || '';
                    const colonIndex = textContent.indexOf(':');
                    const value = (colonIndex !== -1) ? textContent.substring(colonIndex + 1).trim() : textContent.trim();
                    if (pKey) sourceData.pValues[pKey] = value;
                }
            });

            // --- 修改点3: 使用URL参数覆盖默认的重量和捆号 ---
            if (zlParamValue) {
                const sanitizedZl = zlParamValue.replace(/[^\d.-]/g, ''); // 简单过滤，只允许数字、点、负号
                if (sanitizedZl) {
                    sourceData.pValues.weightValue = sanitizedZl; // 更新数据源中的重量值
                    // 直接更新源模板中显示的重量值
                    const sourceWeightValueSpan = sourceDetailsTemplate.querySelector('[data-source-value-part="weightValue"]');
                    if (sourceWeightValueSpan) sourceWeightValueSpan.textContent = sanitizedZl;
                } else {
                    console.warn('无效的 "zl" (重量) URL参数 (过滤后为空):', zlParamValue);
                }
            }
            if (khParamValue) {
                // 对于捆号，通常是字母和数字的组合，不过滤特殊字符，按原样使用
                // 如果需要严格过滤，可以添加如：khParamValue.replace(/[^\w-]/g, '');
                sourceData.pValues.bundleNoValue = khParamValue; // 更新数据源中的捆号值
                // 直接更新源模板中显示的捆号值
                const sourceBundleNoValueSpan = sourceDetailsTemplate.querySelector('[data-source-value-part="bundleNoValue"]');
                if (sourceBundleNoValueSpan) sourceBundleNoValueSpan.textContent = khParamValue;
            }
            // 确保重量单位始终存在 (如果URL只提供了数值)
            if (!sourceData.pValues.weightUnit && sourceDetailsTemplate.querySelector('[data-source-value-part="weightUnit"]')) {
                sourceData.pValues.weightUnit = sourceDetailsTemplate.querySelector('[data-source-value-part="weightUnit"]').textContent.trim() || 'kg';
            }


            // 提取成分信息
            sourceDetailsTemplate.querySelectorAll('[data-source-component]').forEach(compElement => {
                const key = compElement.dataset.sourceComponent;
                const valueElement = compElement.querySelector('[data-source-value]');
                const statusElement = compElement.querySelector('[data-source-status]');
                if (key && valueElement && statusElement) {
                    sourceData.components[key] = {
                        value: valueElement.textContent || '',
                        status: statusElement.textContent || ''
                    };
                }
            });

            // 提取物理特性信息
            const propertiesToCopyFromSource = [
                'actualThickness', 'gaugeCode', 'yieldStrength', 'tensileStrength',
                'yieldRatio', 'bendingAngle', 'bendingDiameter', 'tensileDirection'
            ];
            propertiesToCopyFromSource.forEach(propKey => {
                 const propElement = sourceDetailsTemplate.querySelector(`[data-source-property="${propKey}"]`);
                 const valueElement = propElement?.querySelector('[data-source-value]');
                 const statusElement = propElement?.querySelector('[data-source-status]');
                 if (propElement && valueElement && statusElement){
                    sourceData.properties[propKey] = {
                        value: valueElement.textContent || '',
                        status: statusElement.textContent || ''
                    };
                 }
            });

            // 填充所有目标条目
            const targetItems = document.querySelectorAll('[data-target-item]');
            targetItems.forEach(targetItem => {
                const targetDetails = targetItem.nextElementSibling;
                if (!targetDetails || !targetDetails.hasAttribute('data-target-details')) return;

                const targetIdField = targetItem.querySelector('[data-target-field="idText"]');
                if (targetIdField) targetIdField.textContent = sourceData.idText;
                const targetDateField = targetItem.querySelector('[data-target-field="dateText"]');
                if (targetDateField) targetDateField.textContent = sourceData.dateText;

                // 填充 <p> 标签数据, 包括新的重量和捆号部分
                for (const key in sourceData.pValues) {
                    const targetPValueSpan = targetDetails.querySelector(`[data-target-value-for-p="${key}"]`);
                    if (targetPValueSpan) {
                         targetPValueSpan.textContent = sourceData.pValues[key];
                    }
                }

                // 填充物理特性
                for (const key in sourceData.properties) {
                     const targetPropEntry = targetDetails.querySelector(`[data-target-property="${key}"]`);
                     if (targetPropEntry) {
                         const targetValueSpan = targetPropEntry.querySelector('[data-target-value]');
                         const targetStatusSpan = targetPropEntry.querySelector('[data-target-status]');
                         if (targetValueSpan && sourceData.properties[key]?.value !== undefined) targetValueSpan.textContent = sourceData.properties[key].value;
                         if (targetStatusSpan && sourceData.properties[key]?.status !== undefined) targetStatusSpan.textContent = sourceData.properties[key].status;
                     }
                }

                // 特殊处理条目6的成分信息
                if (targetDetails.dataset.itemIndex === '6') {
                    for (const key in sourceData.components) {
                        const targetCompEntry = targetDetails.querySelector(`[data-target-component="${key}"]`);
                        if (targetCompEntry) {
                            const targetValueSpan = targetCompEntry.querySelector('[data-target-value]');
                            const targetStatusSpan = targetCompEntry.querySelector('[data-target-status]');
                            if (targetValueSpan && sourceData.components[key]?.value !== undefined) targetValueSpan.textContent = sourceData.components[key].value;
                            if (targetStatusSpan && sourceData.components[key]?.status !== undefined) targetStatusSpan.textContent = sourceData.components[key].status;
                        }
                    }
                }
            });

            // --- 折叠/展开逻辑 (保持不变) ---
            const warrantyItems = document.querySelectorAll('.warranty-item'); 
            warrantyItems.forEach(item => {
                item.addEventListener('click', function() {
                    const currentDetails = this.nextElementSibling;
                    const isActive = this.classList.contains('active');
                    document.querySelectorAll('.warranty-item').forEach(otherItem => {
                        if (otherItem !== this) {
                            otherItem.classList.remove('active');
                            const otherDetails = otherItem.nextElementSibling;
                            if (otherDetails && otherDetails.classList.contains('warranty-details') && !otherDetails.classList.contains('full-width-image-area')) { 
                                otherDetails.classList.remove('expanded');
                            }
                        }
                    });
                    if (currentDetails && currentDetails.classList.contains('warranty-details') && !currentDetails.classList.contains('full-width-image-area')) {
                        if (isActive) {
                            this.classList.remove('active');
                            currentDetails.classList.remove('expanded');
                        } else {
                            this.classList.add('active');
                            currentDetails.classList.add('expanded');
                        }
                    }
                });
            });

            // --- 灯箱逻辑 (保持不变) ---
            const originalCertificateImage = certificateImageElement; 
            const lightbox = document.getElementById('imageLightbox'); 
            const lightboxImg = document.getElementById('lightboxImage');
            let lightboxZoomState = 0; 
            let clickTimer = null;

            if (originalCertificateImage && lightbox && lightboxImg) {
                originalCertificateImage.addEventListener('click', function() {
                    openLightbox(this.src); 
                });

                function openLightbox(src) {
                    lightboxImg.src = src;
                    lightboxZoomState = 1; 
                    lightboxImg.classList.remove('lightbox-image-zoomed');
                    lightbox.classList.remove('is-scrollable'); 
                    lightbox.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                }

                function closeLightbox() {
                    lightbox.style.display = 'none';
                    lightboxImg.src = '';
                    lightboxZoomState = 0; 
                    document.body.style.overflow = 'auto';
                    lightboxImg.classList.remove('lightbox-image-zoomed');
                    lightbox.classList.remove('is-scrollable'); 
                }

                lightbox.addEventListener('click', function(event) {
                    if (event.target === lightbox) { 
                        closeLightbox();
                    }
                });

                lightboxImg.addEventListener('click', function(event) {
                    event.stopPropagation(); 
                    if (clickTimer) { 
                        clearTimeout(clickTimer);
                        clickTimer = null;
                        handleDoubleClick();
                    } else { 
                        clickTimer = setTimeout(() => {
                            clickTimer = null;
                            handleSingleClick();
                        }, 250); 
                    }
                });
                
                function handleSingleClick() {
                    closeLightbox();
                }

                function handleDoubleClick() {
                    if (lightboxZoomState === 1) { 
                        lightboxImg.classList.add('lightbox-image-zoomed');
                        lightbox.classList.add('is-scrollable'); 
                        lightboxZoomState = 2;
                    } else if (lightboxZoomState === 2) { 
                        lightboxImg.classList.remove('lightbox-image-zoomed');
                        lightbox.classList.remove('is-scrollable'); 
                        lightboxZoomState = 1;
                    }
                }

                document.addEventListener('keydown', function(event) {
                    if (event.key === 'Escape' && lightboxZoomState !== 0) {
                        closeLightbox();
                    }
                });

            } else {
                if (!originalCertificateImage) console.error('原始证书图片（用于灯箱）未找到！');
                if (!lightbox) console.error('灯箱覆盖层元素未找到！');
                if (!lightboxImg) console.error('灯箱图片元素未找到！');
            }
        });
    </script>
</body>
</html>